{% extends "base.html" %} {% block title %}Details - {{ book.title if book else 'Error' }}{% endblock %} {% block
extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/details.css', v=static_version) }}" />
{% endblock %} {% block extra_js %}{% endblock %} {% block content %} {% if error %}
<div class="error-message">
    <p>{{ error }}</p>
    <p><a href="javascript:history.back()" style="color: inherit; font-weight: bold">← Back to Search</a></p>
</div>
{% elif book %}

<div class="details-container">
    <div class="details-left">
        {% set default_cover_url = url_for('static', filename='images/' + default_cover_filename, v=static_version) %}
        <img
            src="{{ book.cover if book.cover else default_cover_url }}"
            alt="Cover"
            class="details-cover"
            onerror="this.src='{{ default_cover_url }}'"
        />
    </div>

    <div class="details-info">
        <a href="javascript:history.back()" class="back-link" style="margin-bottom: 10px; display: inline-block"
            >← Back to results</a
        >
        <h2>{{ book.title }}</h2>

        <div class="meta-info">
            <p><strong>Author:</strong> {{ book.author }}</p>
            <p><strong>Narrator:</strong> {{ book.narrator }}</p>
            <p><strong>Language:</strong> {{ book.language }}</p>
            <p><strong>Category:</strong> {{ book.category if book.category else 'Unknown' }}</p>
            <p><strong>Format:</strong> {{ book.format }} @ {{ book.bitrate }}</p>
            <p><strong>Size:</strong> {{ book.file_size }}</p>
            <p style="grid-column: 1 / -1"><strong>Hash:</strong> <code>{{ book.info_hash }}</code></p>
        </div>

        <div class="action-bar">
            <button
                class="details-download-btn"
                onclick="sendTorrent('{{ book.link|escape }}', '{{ book.title|escape }}', this)"
            >
                Download to Server
            </button>

            <button class="direct-link-btn" onclick="openExternalLink('{{ book.link|escape }}')">
                Open External Page
            </button>
        </div>

        <div class="details-description">
            <h3>Description</h3>
            {{ book.description | safe }}
        </div>

        {% if book.trackers %}
        <div class="tracker-list">
            <strong>Trackers:</strong>
            <ul>
                {% for tracker in book.trackers %}
                <li>{{ tracker }}</li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </div>
</div>
{% endif %} {% endblock %}
